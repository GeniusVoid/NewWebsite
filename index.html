<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Grammar & Fluency Fixer</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at top, #020617, #020202 55%, #020617);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 16px;
      color: #e5e7eb;
    }

    .app {
      width: 100%;
      max-width: 720px;
      background: rgba(15, 23, 42, 0.96);
      border-radius: 24px;
      padding: 18px 16px 20px;
      box-shadow:
        0 18px 60px rgba(0, 0, 0, 0.8),
        0 0 0 1px rgba(148, 163, 184, 0.12);
      backdrop-filter: blur(16px);
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      gap: 12px;
    }

    .title-block {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .title {
      font-size: 1.2rem;
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: #c7d2fe;
    }

    .subtitle {
      font-size: 0.8rem;
      color: #9ca3af;
    }

    .pill {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(56, 189, 248, 0.5);
      font-size: 0.7rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #67e8f9;
      white-space: nowrap;
    }

    .label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #6b7280;
      margin-bottom: 6px;
    }

    textarea {
      width: 100%;
      min-height: 160px;
      border-radius: 16px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: radial-gradient(circle at top left, #020617, #020617 40%, #030712);
      color: #e5e7eb;
      padding: 12px 14px;
      resize: vertical;
      font-size: 0.95rem;
      line-height: 1.5;
      outline: none;
      transition: border 0.12s ease, box-shadow 0.12s ease, background 0.12s ease;
    }

    textarea:focus {
      border-color: #4f46e5;
      box-shadow: 0 0 0 1px rgba(79, 70, 229, 0.4);
      background: radial-gradient(circle at top left, #020617, #020617 35%, #020617);
    }

    .section {
      margin-bottom: 14px;
    }

    .actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      margin-top: 8px;
      margin-bottom: 10px;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 10px 18px;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      outline: none;
      transition: transform 0.07s ease, box-shadow 0.07s ease, background 0.12s ease;
      touch-action: manipulation;
      white-space: nowrap;
    }

    .btn-primary {
      background: linear-gradient(135deg, #4f46e5, #6366f1);
      color: white;
      box-shadow: 0 10px 25px rgba(55, 48, 163, 0.7);
    }

    .btn-primary:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: 0 4px 12px rgba(55, 48, 163, 0.8);
      background: linear-gradient(135deg, #4338ca, #4f46e5);
    }

    .btn-secondary {
      background: rgba(31, 41, 55, 0.9);
      color: #e5e7eb;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.6);
    }

    .btn-secondary:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: 0 3px 7px rgba(0, 0, 0, 0.7);
      background: rgba(17, 24, 39, 0.95);
    }

    button:disabled {
      opacity: 0.6;
      cursor: default;
      transform: none;
      box-shadow: none;
    }

    .status {
      font-size: 0.8rem;
      color: #9ca3af;
      flex: 1 1 auto;
      min-width: 140px;
    }

    .status strong {
      color: #a5b4fc;
    }

    .output-box {
      border-radius: 16px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: radial-gradient(circle at top right, #020617, #020617 40%, #030712);
      padding: 12px 14px;
      min-height: 90px;
      font-size: 0.95rem;
      line-height: 1.5;
      color: #e5e7eb;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    .placeholder {
      color: #6b7280;
      font-size: 0.9rem;
    }

    .footer {
      margin-top: 8px;
      font-size: 0.75rem;
      color: #6b7280;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }

    .counter {
      font-variant-numeric: tabular-nums;
    }

    @media (max-width: 520px) {
      .header {
        flex-direction: column;
        align-items: flex-start;
      }
      .pill {
        align-self: flex-start;
      }
      .app {
        padding: 16px 12px 18px;
        border-radius: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="header">
      <div class="title-block">
        <div class="title">AI Grammar Fixer</div>
        <div class="subtitle">Paste your paragraph. Get a cleaner, fluent version.</div>
      </div>
      <div class="pill">Free â€¢ English â€¢ Instant</div>
    </header>

    <section class="section">
      <div class="label">Original text</div>
      <textarea
        id="inputText"
        placeholder="Paste or type your paragraph here. Then tap &quot;Improve with AI&quot;."
      ></textarea>
      <div class="actions">
        <button id="improveBtn" class="btn-primary">
          âš¡ Improve with AI
        </button>
        <button id="clearBtn" class="btn-secondary">
          ðŸ§¹ Clear
        </button>
        <div id="status" class="status">
          Ready.
        </div>
      </div>
    </section>

    <section class="section">
      <div class="label">Improved text</div>
      <div id="output" class="output-box">
        <span class="placeholder">Your corrected paragraph will appear here.</span>
      </div>
      <div class="actions" style="margin-top: 8px;">
        <button id="copyBtn" class="btn-secondary">
          ðŸ“‹ Copy improved text
        </button>
        <div class="status counter" id="counter">
          0 characters â€¢ 0 words
        </div>
      </div>
    </section>

    <footer class="footer">
      <span>Powered by LanguageTool public API.</span>
      <span>Tip: keep paragraphs under a few thousand characters.</span>
    </footer>
  </div>

  <script>
    const inputEl = document.getElementById("inputText");
    const outputEl = document.getElementById("output");
    const improveBtn = document.getElementById("improveBtn");
    const clearBtn = document.getElementById("clearBtn");
    const copyBtn = document.getElementById("copyBtn");
    const statusEl = document.getElementById("status");
    const counterEl = document.getElementById("counter");

    function updateCounter() {
      const text = inputEl.value;
      const chars = text.length;
      const words = text.trim() ? text.trim().split(/\s+/).length : 0;
      counterEl.textContent = chars + " characters â€¢ " + words + " words";
    }

    inputEl.addEventListener("input", updateCounter);
    updateCounter();

    clearBtn.addEventListener("click", () => {
      inputEl.value = "";
      outputEl.innerHTML = '<span class="placeholder">Your corrected paragraph will appear here.</span>';
      statusEl.textContent = "Cleared.";
      updateCounter();
    });

    copyBtn.addEventListener("click", async () => {
      const text = outputEl.textContent.trim();
      if (!text || text === "Your corrected paragraph will appear here.") return;
      try {
        await navigator.clipboard.writeText(text);
        statusEl.innerHTML = "<strong>Copied improved text.</strong>";
      } catch (e) {
        statusEl.textContent = "Copy failed. Select text and copy manually.";
      }
    });

    improveBtn.addEventListener("click", async () => {
      const text = inputEl.value.trim();
      if (!text) {
        statusEl.textContent = "Type or paste some text first.";
        inputEl.focus();
        return;
      }

      improveBtn.disabled = true;
      clearBtn.disabled = true;
      copyBtn.disabled = true;
      statusEl.innerHTML = "<strong>Fixing grammar and fluencyâ€¦</strong>";

      try {
        const response = await fetch("https://api.languagetool.org/v2/check", {
          method: "POST",
          headers: {
            "Content-Type": "application/x-www-form-urlencoded"
          },
          body: new URLSearchParams({
            text: text,
            language: "en-US"
          })
        });

        if (!response.ok) {
          throw new Error("API error: " + response.status);
        }

        const data = await response.json();

        let corrected = text.split(""); // work on char array

        // Process from end to start so offsets stay valid
        const matches = (data.matches || []).slice().sort((a, b) => b.offset - a.offset);

        for (const m of matches) {
          if (!m.replacements || m.replacements.length === 0) continue;
          const repl = m.replacements[0].value;
          const start = m.offset;
          const len = m.length;
          if (start >= 0 && start + len <= corrected.length) {
            corrected.splice(start, len, ...repl.split(""));
          }
        }

        const resultText = corrected.join("");

        outputEl.textContent = resultText;
        statusEl.innerHTML = "<strong>Done.</strong> Review once before using.";
      } catch (err) {
        console.error(err);
        statusEl.textContent = "Error talking to AI. Try again in a moment.";
      } finally {
        improveBtn.disabled = false;
        clearBtn.disabled = false;
        copyBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
